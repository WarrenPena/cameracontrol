<!DOCTYPE HTML>
<html>
	<head>
		<title>Cameras</title>
		<script src="jquery-1.6.2.js"></script>
		<script src="presets.js"></script>
		<script src="movebystep.js"></script>

		<link rel="stylesheet" type="text/css" href="cameras.css" />
	</head>

	<body>
		<div>
			<h2 class="boldaccent">Axis Back</h2>
			<div id="axisBack" class="cameraControls" camera="1">
				<div id="axisBackPreview" style="float:left">
					<img src="http://10.0.5.5/mjpg/video.mjpg" width="320" height="240">
				</div>
				<div id="axisBackControl" class="btnControlGroup">
					<br>
					<div class="btnGroup">
						<div class="moveBtn"><button id="btnAxisBackUpLeft" class="moveButton" camera="back" direction="upleft">Up-Left</button></div>
						<div class="moveBtn"><button id="btnAxisBackUp" class="moveButton" camera="back" direction="up">Up</button></div>
						<div class="moveBtn"><button id="btnAxisBackUpRight" class="moveButton" camera="back" direction="upright">Up-Right</button></div>
						<div class="moveBtn"><button id="btnAxisBackLeft"  class="moveButton" camera="back" direction="left">Left</button></div>
						<div class="moveBtn"><button id="btnAxisBackNothing" class="doNothingButton" camera="back" direction="nothing"></button></div>
						<div class="moveBtn"><button id="btnAxisBackRight" class="moveButton" camera="back" direction="right">Right</button></div>
						<div class="moveBtn"><button id="btnAxisBackDownLeft" class="moveButton" camera="back" direction="downleft">Down-Left</button></div>
						<div class="moveBtn"><button id="btnAxisBackDown" class="moveButton" camera="back" direction="down">Down</button></div>
						<div class="moveBtn"><button id="btnAxisBackDownRight" class="moveButton" camera="back" direction="downright">Down-Right</button></div>
					</div>
					<br>
					<div class="btnGroup">
						<div class="zoomBtn"><button id="btnAxisBackIn"  class="zoomButton" camera="back" direction="500">In</button></div>
						<div class="zoomBtn"><button id="btnAxisBackIn"  class="zoomButton" camera="back" direction="-500">Out</button></div>
						<div class="irisBtn"><button class="irisButton" camera="1" direction="open">Iris Open</button></div>
						<div class="irisBtn"><button class="irisButton" camera="1" direction="close">Iris Close</button></div>
					</div>
				</div>
				<div class="presets" camera="1" style="float:left;padding-left:50px">
					<div class="divPresetsList" camera="1" style="width:200px;height:230px;border-style:solid;border-color:#AAAAAA;overflow:auto"></div>
					<div class="divPresetsControls">
						<button camera="1" class="presetBtn presetGoButton">Go</button>
						<button camera="1" class="presetBtn presetNewButton">New</button>
						<button camera="1" class="presetBtn presetDeleteButton">Delete</button>
					</div>
				</div>
			</div>
		</div>
		<div style="clear:both;padding-top:5px">
			<h2 class="boldaccent">Axis Left</h2>
			<div id="axisLeft" class="cameraControls" camera="2">
				<div id="axisLeftPreview" style="float:left">
					<img src="http://10.0.5.6/mjpg/video.mjpg" width="320" height="240">
				</div>
				<div id="axisLeftControl" class="btnControlGroup"><br>

					<div class="btnGroup">
						<div class="moveBtn"><button id="btnAxisBackUpLeft" class="moveButton" camera="left" direction="upleft">Up-Left</button></div>
						<div class="moveBtn"><button id="btnAxisBackUp" class="moveButton" camera="left" direction="up">Up</button></div>
						<div class="moveBtn"><button id="btnAxisBackUpRight" class="moveButton" camera="left" direction="upright">Up-Right</button></div>
						<div class="moveBtn"><button id="btnAxisBackLeft"  class="moveButton" camera="left" direction="left">Left</button></div>
						<div class="moveBtn"><button id="btnAxisBackNothing" class="doNothingButton" camera="left" direction="nothing"></button></div>
						<div class="moveBtn"><button id="btnAxisBackRight" class="moveButton" camera="left" direction="right">Right</button></div>
						<div class="moveBtn"><button id="btnAxisBackDownLeft" class="moveButton" camera="left" direction="downleft">Down-Left</button></div>
						<div class="moveBtn"><button id="btnAxisBackDown" class="moveButton" camera="left" direction="down">Down</button></div>
						<div class="moveBtn"><button id="btnAxisBackDownRight" class="moveButton" camera="left" direction="downright">Down-Right</button></div>
					</div>

					<br>

					<div class="btnGroup">
						<div class="zoomBtn"><button id="btnAxisBackIn"  class="zoomButton" camera="left" direction="500">In</button></div>
						<div class="zoomBtn"><button id="btnAxisBackIn"  class="zoomButton" camera="left" direction="-500">Out</button></div>
						<div class="irisBtn"><button class="irisButton" camera="2" direction="open">Iris Open</button></div>
						<div class="irisBtn"><button class="irisButton" camera="2" direction="close">Iris Close</button></div>
					</div>
				</div>

				<div class="presets" camera="1" style="float:left;padding-left:50px">
					<div class="divPresetsList" camera="2" style="width:200px;height:230px;border-style:solid;border-color:#AAAAAA;overflow:auto"></div>
					<div class="divPresetsControls">
						<button camera="2" class="presetBtn presetGoButton">Go</button>
						<button camera="2" class="presetBtn presetNewButton">New</button>
						<button camera="2" class="presetBtn presetDeleteButton">Delete</button>
					</div>
				</div>
			</div>
		</div>

		<div style='clear:both'>
			<br>
			<hr>
			<div id='divLive'>
			</div>
		</div>

		<script type="text/javascript">
			$(document).ready( function() {
				$(".moveButton").click(moveButtonClick);
				$(".zoomButton").click(zoomButtonClick);

				$(".doNothingButton").click(function() {
					alert("Hey! Listen!");
				});

				// Set up click to center handlers
				//$(".clickToCenter").click(clickToCenter);

				// Set up motion event handlers
				$(".irisButton").click(changeIris);

				// Set up presets event handlers
				presetsLoadAll();
				$(".presetGoButton").click(presetsGo);
				$(".presetNewButton").click(presetsNew);
				$(".presetDeleteButton").click(presetsDelete);

				// Set up camera switching
				$(".switchButton").click(switchToCamera);

				// Set up Sunday Streams Preview
				if (document.createElement('video').canPlayType('application/vnd.apple.mpegURL') != '') {
					var video = $("<video></video>").attr("controls", "controls").attr("autoplay", "autoplay").attr("width", "320").attr("height", "240");
					var source = $("<source></source>").attr("src", "http://i4.netformzcdn.com:1935/SUNS2338TEBJUMsYUmyh/SUNS_2338TEBJUMsYUmyh.sdp/playlist.m3u8").appendTo(video);
					$("#divLive").append(video);
					  //<source src="http://HttpLiveStream.m3u8">
				}
				else {
					$("<iframe></iframe>").attr("width", "640").attr("height", "580").attr("src", "http://www.sundaystreams.com/embed/v2/2338/59753887/1/&w=640&h=580&pp=1&pwh=220").attr("frameborder", "0").appendTo("#divLive");
					$("#divLive").css("max-height", "360px").css("max-width","640px").css("overflow", "hidden");
				}
			});

			/* Motion */
			function moveButtonClick() {
				var camera = $(this).attr("camera");
				var direction = $(this).attr("direction");

				// Translate the camera in to an IP address
				var cameraip = cameraNameToIp(camera);

				// Run the command
				$.ajax({
					url: "http://" + cameraip + "/axis-cgi/com/ptz.cgi",
					data: { "move": direction }
				});
			}

			function zoomButtonClick() {
				var camera = $(this).attr("camera");
				var direction = $(this).attr("direction");

				// Translate the camera in to an IP address
				var cameraip = cameraNameToIp(camera);

				// Run the command
				$.ajax({
					url: "http://" + cameraip + "/axis-cgi/com/ptz.cgi",
					data: { "rzoom": direction }
				});
			}

			function switchToCamera() {
				var camera = $(this).attr("camera");

				$.ajax({
					url: "ajaxCameras.php",
					type: "POST",
					data: {
						"action": "switchToCamera",
						"camera": camera
					},
					dataType: "json",
					success: function(data) {
						if (data.message != "") {
							alert(data.message);
						}
					},
					error: function(data) {
						alert("Error switching to camera");
					}
				});

			}

			function cameraNameToIp(name) {
				var ip;

				switch (name) {
					case "back":
						ip = "10.0.5.5";
						break;

					case "left":
						ip = "10.0.5.6";
						break;

					default:
						alert("Unrecognized camera " + name);
						ip = "0.0.0.0";
						break;
				}

				return ip;
			}
		</script>
	</body>
</html>
